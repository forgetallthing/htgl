webpackJsonp([7],{"1cNm":function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l("skVP"),r={name:"htList",data:function(){return{tableData:[],tableFilterData:[],tableHeight:window.innerHeight-319,filter:{htfhsj:"全部"},filterHidden:{col_htbh:!1,col_htfcsj:!1,col_htfhsj:!1,col_skjd:!1},ms_role:"",form:{htbh:""},rules:{htbh:[{required:!0,message:"请输入合同编号",trigger:"blur"}]},dialogFormVisible:!1,formLabelWidth:"120px",options:[{label:"全部",value:"全部"},{label:"已返回",value:"已返回"},{label:"未返回",value:"未返回"}],options2:[{label:"全部",value:"全部"},{label:"未开始",value:"未开始"},{label:"进行中",value:"进行中"},{label:"已完成",value:"已完成"}],options3:[{label:"全部",value:"全部"}]}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.ms_role=localStorage.getItem("ms_role"),"input"===this.ms_role&&(this.filterHidden={skjd:!0,col_skjd:!0}),"worker"===this.ms_role&&(this.filterHidden={htbh:!0,skjd:!0,col_htbh:!0,col_htfcsj:!0,col_htfhsj:!0,col_skjd:!0});var t=this.$loading({target:".content"});Object(i.h)({}).then(function(l){t.close(),e.tableData=l.value.contracts;var i=[];console.log(l.value.contracts);for(var r=0;r<l.value.contracts.length;r++)l.value.contracts[r].zybm&&-1==i.indexOf(l.value.contracts[r].zybm)&&i.push(l.value.contracts[r].zybm);for(var a=0;a<i.length;a++)e.options3.push({label:i[a],value:i[a]});e.search()},function(e){t.close()}),t.close()},search:function(){var e=this,t=this.tableData.filter(function(t){return(!e.filter.htbh||-1!==t.htbh.indexOf(e.filter.htbh))&&((!e.filter.xmmc||-1!==t.xmmc.indexOf(e.filter.xmmc))&&((!e.filter.wtdw||-1!==t.wtdw.indexOf(e.filter.wtdw))&&((!e.filter.skjd||-1!==t.skjd.indexOf(e.filter.skjd))&&(!("已返回"===e.filter.htfhsj&&!t.htfhsj)&&(("未返回"!==e.filter.htfhsj||!t.htfhsj)&&(("未开始"!==e.filter.xmjd||"未开始"===t.xmjd)&&(("进行中"!==e.filter.xmjd||"进行中"===t.xmjd)&&(("已完成"!==e.filter.xmjd||"已完成"===t.xmjd)&&(!(e.filter.startTime&&t.xmkssj<e.filter.startTime)&&(!(e.filter.endTime&&t.xmkssj>e.filter.endTime)&&(!e.filter.zybm||"全部"==e.filter.zybm||t.zybm==e.filter.zybm)))))))))))});this.tableFilterData=t},showCard:function(){this.dialogFormVisible=!0},newBuild:function(){var e=this,t=this.$loading({target:".content"});Object(i.a)({htbh:this.form.htbh}).then(function(l){t.close(),e.$message.success("新建成功"),e.dialogFormVisible=!1,e.form.htbh="",e.init()},function(e){t.close()})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.newBuild()})},handleEdit:function(e,t){this.$router.push({name:"edit",params:{htbh:t.htbh}})},handleDelete:function(e,t){var l=this;this.$confirm("确认删除？").then(function(e){var r=l.$loading({target:".content"});Object(i.d)({htbh:t.htbh}).then(function(e){r.close(),l.$message.success("删除成功"),l.init()},function(e){r.close()})}).catch(function(e){})}}},a={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"content-outerbox"},[l("el-row",{staticClass:"list"},[l("el-col",{attrs:{span:24}},[l("el-form",{ref:"ruleForm",attrs:{model:e.filter,"label-position":"left","label-width":"100px"}},[l("el-row",{attrs:{gutter:20}},[l("el-col",{attrs:{hidden:e.filterHidden.htbh,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"合同编号:"}},[l("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.filter.htbh,callback:function(t){e.$set(e.filter,"htbh",t)},expression:"filter.htbh"}})],1)],1),e._v(" "),l("el-col",{attrs:{hidden:e.filterHidden.xmmc,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"项目名称:"}},[l("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.filter.xmmc,callback:function(t){e.$set(e.filter,"xmmc",t)},expression:"filter.xmmc"}})],1)],1),e._v(" "),l("el-col",{attrs:{hidden:e.filterHidden.htfcsj,span:2}},[l("el-form-item",{attrs:{"label-width":"100px",label:"项目承接时间:"}})],1),e._v(" "),l("el-col",{attrs:{hidden:e.filterHidden.htfcsj,span:4}},[l("el-date-picker",{staticClass:"date-picker",attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"起始日期"},model:{value:e.filter.startTime,callback:function(t){e.$set(e.filter,"startTime",t)},expression:"filter.startTime"}})],1),e._v(" "),l("el-col",{attrs:{hidden:e.filterHidden.htfcsj,span:4}},[l("el-date-picker",{staticClass:"date-picker",attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"结束日期"},model:{value:e.filter.endTime,callback:function(t){e.$set(e.filter,"endTime",t)},expression:"filter.endTime"}})],1),e._v(" "),l("el-col",{attrs:{hidden:e.filterHidden.wtdw,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"委托单位:"}},[l("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.filter.wtdw,callback:function(t){e.$set(e.filter,"wtdw",t)},expression:"filter.wtdw"}})],1)],1),e._v(" "),l("el-col",{attrs:{hidden:e.filterHidden.skjd,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"收款进度:"}},[l("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.filter.skjd,callback:function(t){e.$set(e.filter,"skjd",t)},expression:"filter.skjd"}})],1)],1),e._v(" "),l("el-col",{attrs:{hidden:e.filterHidden.htfhsj,span:6}},[l("el-form-item",{attrs:{"label-width":"100px",label:"合同返回时间:"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.filter.htfhsj,callback:function(t){e.$set(e.filter,"htfhsj",t)},expression:"filter.htfhsj"}},e._l(e.options,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),l("el-col",{attrs:{hidden:e.filterHidden.xmjd,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"项目进度:"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.filter.xmjd,callback:function(t){e.$set(e.filter,"xmjd",t)},expression:"filter.xmjd"}},e._l(e.options2,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),l("el-col",{attrs:{hidden:e.filterHidden.zybm,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"作业部门:"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.filter.zybm,callback:function(t){e.$set(e.filter,"zybm",t)},expression:"filter.zybm"}},e._l(e.options3,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),l("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[l("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){return e.search()}}},[e._v("搜索")])],1),e._v(" "),l("el-col",{staticStyle:{"text-align":"right"},attrs:{hidden:-1==["input","admin","finance"].indexOf(e.ms_role),span:3}},[l("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){return e.showCard()}}},[e._v("新建")])],1)],1)],1)],1),e._v(" "),l("el-col",[l("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableFilterData,border:"","max-height":e.tableHeight,"default-sort":{prop:"col1",order:"descending"}}},[e.filterHidden.col_htbh?e._e():l("el-table-column",{attrs:{prop:"htbh",label:"合同编号",sortable:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"xmmc",label:"项目名称",sortable:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"wtdw",label:"委托单位",sortable:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"zybm",label:"作业部门",sortable:""}}),e._v(" "),e.filterHidden.col_htfcsj?e._e():l("el-table-column",{attrs:{prop:"htfcsj",label:"合同发出时间",sortable:""}}),e._v(" "),e.filterHidden.col_htfhsj?e._e():l("el-table-column",{attrs:{prop:"htfhsj",label:"合同返回时间",sortable:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"xmkssj",label:"项目开始时间",sortable:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"xmjd",label:"项目进度",sortable:""}}),e._v(" "),e.filterHidden.col_skjd?e._e():l("el-table-column",{attrs:{prop:"skjd",label:"收款进度",sortable:""}}),e._v(" "),l("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{size:"mini"},on:{click:function(l){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),l("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(l){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"新建",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[l("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.form}},[l("el-form-item",{staticStyle:{width:"80%"},attrs:{label:"合同编号","label-width":e.formLabelWidth,prop:"htbh"}},[l("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.htbh,callback:function(t){e.$set(e.form,"htbh",t)},expression:"form.htbh"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var n=l("VU/8")(r,a,!1,function(e){l("QWf4")},"data-v-27028860",null);t.default=n.exports},QWf4:function(e,t){}});