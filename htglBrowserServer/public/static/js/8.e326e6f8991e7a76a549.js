webpackJsonp([8],{"1cNm":function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=l("skVP"),i={name:"htList",data:function(){return{tableData:[],tableFilterData:[],tableHeight:window.innerHeight-330,filter:{htfhsj:"全部"},filterHidden:{col_htbh:!1,col_htfcsj:!1,col_htfhsj:!1,col_skjd:!1},ms_role:"",form:{htbh:""},rules:{htbh:[{required:!0,message:"请输入合同编号",trigger:"blur"}]},dialogFormVisible:!1,formLabelWidth:"120px",options:[{label:"全部",value:"全部"},{label:"已返回",value:"已返回"},{label:"未返回",value:"未返回"}],options2:[{label:"全部",value:"全部"},{label:"未开始",value:"未开始"},{label:"进行中",value:"进行中"},{label:"已完成",value:"已完成"}],options3:[{label:"全部",value:"全部"}]}},created:function(){this.ms_role=localStorage.getItem("ms_role"),"worker"===this.ms_role&&(this.tableHeight=window.innerHeight-295)},mounted:function(){this.init()},methods:{init:function(){var t=this;this.ms_role=localStorage.getItem("ms_role"),"input"===this.ms_role&&(this.filterHidden={skjd:!0,col_skjd:!0}),"worker"===this.ms_role&&(this.filterHidden={htbh:!0,skjd:!0,col_htbh:!0,col_htfcsj:!0,col_htfhsj:!0,col_skjd:!0});var e=this.$loading({target:".content"});Object(r.h)({}).then(function(l){e.close(),t.tableData=l.value.contracts;var r=[];console.log(l.value.contracts);for(var i=0;i<l.value.contracts.length;i++)l.value.contracts[i].zybm&&-1==r.indexOf(l.value.contracts[i].zybm)&&r.push(l.value.contracts[i].zybm);for(var a=0;a<r.length;a++)t.options3.push({label:r[a],value:r[a]});t.search()},function(t){e.close()}),e.close()},search:function(){var t=this,e=this.tableData.filter(function(e){return(!t.filter.htbh||-1!==e.htbh.indexOf(t.filter.htbh))&&((!t.filter.xmmc||-1!==e.xmmc.indexOf(t.filter.xmmc))&&((!t.filter.wtdw||-1!==e.wtdw.indexOf(t.filter.wtdw))&&((!t.filter.skjd||-1!==e.skjd.indexOf(t.filter.skjd))&&(!("已返回"===t.filter.htfhsj&&!e.htfhsj)&&(("未返回"!==t.filter.htfhsj||!e.htfhsj)&&(("未开始"!==t.filter.xmjd||"未开始"===e.xmjd)&&(("进行中"!==t.filter.xmjd||"进行中"===e.xmjd)&&(("已完成"!==t.filter.xmjd||"已完成"===e.xmjd)&&(!(t.filter.startTime&&e.xmkssj<t.filter.startTime)&&(!(t.filter.endTime&&e.xmkssj>t.filter.endTime)&&(!t.filter.zybm||"全部"==t.filter.zybm||e.zybm==t.filter.zybm)))))))))))});this.tableFilterData=e},showCard:function(){this.dialogFormVisible=!0},newBuild:function(){var t=this,e=this.$loading({target:".content"});Object(r.a)({htbh:this.form.htbh}).then(function(l){e.close(),t.$message.success("新建成功"),t.dialogFormVisible=!1,t.form.htbh="",t.init()},function(t){e.close()})},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.newBuild()})},handleEdit:function(t,e){this.$router.push({name:"edit",params:{htbh:e.htbh}})},handleDelete:function(t,e){var l=this;this.$confirm("确认删除？").then(function(t){var i=l.$loading({target:".content"});Object(r.d)({htbh:e.htbh}).then(function(t){i.close(),l.$message.success("删除成功"),l.init()},function(t){i.close()})}).catch(function(t){})}}},a={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"content-outerbox"},[l("el-row",{staticClass:"list"},[l("el-col",{attrs:{span:24}},[l("el-form",{ref:"ruleForm",attrs:{model:t.filter,"label-position":"left","label-width":"100px"}},[l("el-row",{attrs:{gutter:20}},[l("el-col",{attrs:{hidden:t.filterHidden.htbh,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"合同编号:"}},[l("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()}},model:{value:t.filter.htbh,callback:function(e){t.$set(t.filter,"htbh",e)},expression:"filter.htbh"}})],1)],1),t._v(" "),l("el-col",{attrs:{hidden:t.filterHidden.xmmc,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"项目名称:"}},[l("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()}},model:{value:t.filter.xmmc,callback:function(e){t.$set(t.filter,"xmmc",e)},expression:"filter.xmmc"}})],1)],1),t._v(" "),l("el-col",{attrs:{hidden:t.filterHidden.htfcsj,span:12}},[l("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{"label-width":"100px",label:"项目承接时间:"}},[l("el-row",{staticStyle:{"padding-top":"0","padding-bottom":"0"},attrs:{gutter:20}},[l("el-col",{attrs:{span:12}},[l("el-date-picker",{staticClass:"date-picker",attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"起始日期"},model:{value:t.filter.startTime,callback:function(e){t.$set(t.filter,"startTime",e)},expression:"filter.startTime"}})],1),t._v(" "),l("el-col",{attrs:{span:12}},[l("el-date-picker",{staticClass:"date-picker",attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"结束日期"},model:{value:t.filter.endTime,callback:function(e){t.$set(t.filter,"endTime",e)},expression:"filter.endTime"}})],1)],1)],1)],1),t._v(" "),l("el-col",{attrs:{hidden:t.filterHidden.wtdw,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"委托单位:"}},[l("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()}},model:{value:t.filter.wtdw,callback:function(e){t.$set(t.filter,"wtdw",e)},expression:"filter.wtdw"}})],1)],1),t._v(" "),l("el-col",{attrs:{hidden:t.filterHidden.skjd,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"收款进度:"}},[l("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()}},model:{value:t.filter.skjd,callback:function(e){t.$set(t.filter,"skjd",e)},expression:"filter.skjd"}})],1)],1),t._v(" "),l("el-col",{attrs:{hidden:t.filterHidden.htfhsj,span:6}},[l("el-form-item",{attrs:{"label-width":"100px",label:"合同返回时间:"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:t.filter.htfhsj,callback:function(e){t.$set(t.filter,"htfhsj",e)},expression:"filter.htfhsj"}},t._l(t.options,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1),t._v(" "),l("el-col",{attrs:{hidden:t.filterHidden.xmjd,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"项目进度:"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:t.filter.xmjd,callback:function(e){t.$set(t.filter,"xmjd",e)},expression:"filter.xmjd"}},t._l(t.options2,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1),t._v(" "),l("el-col",{attrs:{hidden:t.filterHidden.zybm,span:6}},[l("el-form-item",{attrs:{"label-width":"80px",label:"作业部门:"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:t.filter.zybm,callback:function(e){t.$set(t.filter,"zybm",e)},expression:"filter.zybm"}},t._l(t.options3,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1),t._v(" "),l("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[l("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(e){return t.search()}}},[t._v("搜索")])],1),t._v(" "),l("el-col",{staticStyle:{"text-align":"right"},attrs:{hidden:-1==["input","admin","finance"].indexOf(t.ms_role),span:3}},[l("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(e){return t.showCard()}}},[t._v("新建")])],1)],1)],1)],1),t._v(" "),l("el-col",[l("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.tableFilterData,border:"","max-height":t.tableHeight,"default-sort":{prop:"col1",order:"descending"}}},[t.filterHidden.col_htbh?t._e():l("el-table-column",{attrs:{prop:"htbh",label:"合同编号",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{prop:"xmmc",label:"项目名称",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{prop:"wtdw",label:"委托单位",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{prop:"zybm",label:"作业部门",sortable:""}}),t._v(" "),t.filterHidden.col_htfcsj?t._e():l("el-table-column",{attrs:{prop:"htfcsj",label:"合同发出时间",sortable:""}}),t._v(" "),t.filterHidden.col_htfhsj?t._e():l("el-table-column",{attrs:{prop:"htfhsj",label:"合同返回时间",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{prop:"xmkssj",label:"项目开始时间",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{prop:"xmjd",label:"项目进度",sortable:""}}),t._v(" "),t.filterHidden.col_skjd?t._e():l("el-table-column",{attrs:{prop:"skjd",label:"收款进度",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{size:"mini"},on:{click:function(l){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),l("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(l){return t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1)],1)],1),t._v(" "),l("el-dialog",{attrs:{title:"新建",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[l("el-form",{ref:"ruleForm",attrs:{rules:t.rules,model:t.form}},[l("el-form-item",{staticStyle:{width:"80%"},attrs:{label:"合同编号","label-width":t.formLabelWidth,prop:"htbh"}},[l("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.htbh,callback:function(e){t.$set(t.form,"htbh",e)},expression:"form.htbh"}})],1)],1),t._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var n=l("VU/8")(i,a,!1,function(t){l("Lfxt")},"data-v-1d89d297",null);e.default=n.exports},Lfxt:function(t,e){}});